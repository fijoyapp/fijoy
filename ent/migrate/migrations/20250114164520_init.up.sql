-- create "currencies" table
CREATE TABLE "currencies" ("id" bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY (START WITH 4294967296), "code" character varying NOT NULL, PRIMARY KEY ("id"));
-- create index "currencies_code_key" to table: "currencies"
CREATE UNIQUE INDEX "currencies_code_key" ON "currencies" ("code");
-- create "households" table
CREATE TABLE "households" ("id" bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY (START WITH 8589934592), "create_time" timestamptz NOT NULL, "update_time" timestamptz NOT NULL, "name" character varying NOT NULL, "locale" character varying NOT NULL, "currency_id" bigint NOT NULL, PRIMARY KEY ("id"), CONSTRAINT "households_currencies_households" FOREIGN KEY ("currency_id") REFERENCES "currencies" ("id") ON UPDATE NO ACTION ON DELETE NO ACTION);
-- create "users" table
CREATE TABLE "users" ("id" bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY (START WITH 21474836480), "create_time" timestamptz NOT NULL, "update_time" timestamptz NOT NULL, "email" character varying NOT NULL, "name" character varying NOT NULL, PRIMARY KEY ("id"));
-- create index "users_email_key" to table: "users"
CREATE UNIQUE INDEX "users_email_key" ON "users" ("email");
-- create "accounts" table
CREATE TABLE "accounts" ("id" bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY, "create_time" timestamptz NOT NULL, "update_time" timestamptz NOT NULL, "name" character varying NOT NULL, "type" character varying NOT NULL, "balance" numeric(36,18) NOT NULL, "icon_path" character varying NULL, "value" numeric(36,18) NOT NULL, "fx_rate" numeric(36,18) NOT NULL, "currency_id" bigint NOT NULL, "household_id" bigint NOT NULL, "user_id" bigint NOT NULL, PRIMARY KEY ("id"), CONSTRAINT "accounts_currencies_accounts" FOREIGN KEY ("currency_id") REFERENCES "currencies" ("id") ON UPDATE NO ACTION ON DELETE NO ACTION, CONSTRAINT "accounts_households_accounts" FOREIGN KEY ("household_id") REFERENCES "households" ("id") ON UPDATE NO ACTION ON DELETE NO ACTION, CONSTRAINT "accounts_users_accounts" FOREIGN KEY ("user_id") REFERENCES "users" ("id") ON UPDATE NO ACTION ON DELETE NO ACTION);
-- create "investments" table
CREATE TABLE "investments" ("id" bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY (START WITH 30064771072), "create_time" timestamptz NOT NULL, "update_time" timestamptz NOT NULL, "name" character varying NOT NULL, "type" character varying NOT NULL, "symbol" character varying NOT NULL, "amount" numeric(36,18) NOT NULL, "quote" numeric(36,18) NOT NULL, "value" numeric(36,18) NOT NULL, "account_id" bigint NOT NULL, "currency_id" bigint NOT NULL, "household_id" bigint NOT NULL, PRIMARY KEY ("id"), CONSTRAINT "investments_accounts_investments" FOREIGN KEY ("account_id") REFERENCES "accounts" ("id") ON UPDATE NO ACTION ON DELETE NO ACTION, CONSTRAINT "investments_currencies_investments" FOREIGN KEY ("currency_id") REFERENCES "currencies" ("id") ON UPDATE NO ACTION ON DELETE NO ACTION, CONSTRAINT "investments_households_investments" FOREIGN KEY ("household_id") REFERENCES "households" ("id") ON UPDATE NO ACTION ON DELETE NO ACTION);
-- create "transaction_categories" table
CREATE TABLE "transaction_categories" ("id" bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY (START WITH 38654705664), "create_time" timestamptz NOT NULL, "update_time" timestamptz NOT NULL, "name" character varying NOT NULL, "type" character varying NOT NULL, "household_id" bigint NOT NULL, PRIMARY KEY ("id"), CONSTRAINT "transaction_categories_households_transaction_categories" FOREIGN KEY ("household_id") REFERENCES "households" ("id") ON UPDATE NO ACTION ON DELETE NO ACTION);
-- create index "transactioncategory_name_household_id" to table: "transaction_categories"
CREATE UNIQUE INDEX "transactioncategory_name_household_id" ON "transaction_categories" ("name", "household_id");
-- create "transactions" table
CREATE TABLE "transactions" ("id" bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY (START WITH 12884901888), "create_time" timestamptz NOT NULL, "update_time" timestamptz NOT NULL, "description" character varying NULL, "datetime" timestamptz NOT NULL, "household_id" bigint NOT NULL, "category_id" bigint NOT NULL, "user_id" bigint NOT NULL, PRIMARY KEY ("id"), CONSTRAINT "transactions_households_transactions" FOREIGN KEY ("household_id") REFERENCES "households" ("id") ON UPDATE NO ACTION ON DELETE NO ACTION, CONSTRAINT "transactions_transaction_categories_transactions" FOREIGN KEY ("category_id") REFERENCES "transaction_categories" ("id") ON UPDATE NO ACTION ON DELETE NO ACTION, CONSTRAINT "transactions_users_transactions" FOREIGN KEY ("user_id") REFERENCES "users" ("id") ON UPDATE NO ACTION ON DELETE NO ACTION);
-- create index "transaction_datetime" to table: "transactions"
CREATE INDEX "transaction_datetime" ON "transactions" ("datetime");
-- create "investment_lots" table
CREATE TABLE "investment_lots" ("id" bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY (START WITH 47244640256), "create_time" timestamptz NOT NULL, "update_time" timestamptz NOT NULL, "amount" numeric(36,18) NOT NULL, "price" numeric(36,18) NOT NULL, "household_id" bigint NOT NULL, "investment_id" bigint NOT NULL, "transaction_id" bigint NOT NULL, PRIMARY KEY ("id"), CONSTRAINT "investment_lots_households_investment_lots" FOREIGN KEY ("household_id") REFERENCES "households" ("id") ON UPDATE NO ACTION ON DELETE NO ACTION, CONSTRAINT "investment_lots_investments_investment_lots" FOREIGN KEY ("investment_id") REFERENCES "investments" ("id") ON UPDATE NO ACTION ON DELETE NO ACTION, CONSTRAINT "investment_lots_transactions_investment_lots" FOREIGN KEY ("transaction_id") REFERENCES "transactions" ("id") ON UPDATE NO ACTION ON DELETE NO ACTION);
-- create "transaction_entries" table
CREATE TABLE "transaction_entries" ("id" bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY (START WITH 17179869184), "create_time" timestamptz NOT NULL, "update_time" timestamptz NOT NULL, "amount" numeric(36,18) NOT NULL, "account_id" bigint NOT NULL, "currency_id" bigint NOT NULL, "household_id" bigint NOT NULL, "transaction_id" bigint NOT NULL, PRIMARY KEY ("id"), CONSTRAINT "transaction_entries_accounts_transaction_entries" FOREIGN KEY ("account_id") REFERENCES "accounts" ("id") ON UPDATE NO ACTION ON DELETE NO ACTION, CONSTRAINT "transaction_entries_currencies_transaction_entries" FOREIGN KEY ("currency_id") REFERENCES "currencies" ("id") ON UPDATE NO ACTION ON DELETE NO ACTION, CONSTRAINT "transaction_entries_households_transaction_entries" FOREIGN KEY ("household_id") REFERENCES "households" ("id") ON UPDATE NO ACTION ON DELETE NO ACTION, CONSTRAINT "transaction_entries_transactions_transaction_entries" FOREIGN KEY ("transaction_id") REFERENCES "transactions" ("id") ON UPDATE NO ACTION ON DELETE NO ACTION);
-- create "user_households" table
CREATE TABLE "user_households" ("id" bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY (START WITH 25769803776), "create_time" timestamptz NOT NULL, "update_time" timestamptz NOT NULL, "role" character varying NOT NULL, "user_id" bigint NOT NULL, "household_id" bigint NOT NULL, PRIMARY KEY ("id"), CONSTRAINT "user_households_households_household" FOREIGN KEY ("household_id") REFERENCES "households" ("id") ON UPDATE NO ACTION ON DELETE NO ACTION, CONSTRAINT "user_households_users_user" FOREIGN KEY ("user_id") REFERENCES "users" ("id") ON UPDATE NO ACTION ON DELETE NO ACTION);
-- create index "userhousehold_user_id_household_id" to table: "user_households"
CREATE UNIQUE INDEX "userhousehold_user_id_household_id" ON "user_households" ("user_id", "household_id");
-- create "user_keys" table
CREATE TABLE "user_keys" ("id" bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY (START WITH 42949672960), "create_time" timestamptz NOT NULL, "update_time" timestamptz NOT NULL, "provider" character varying NOT NULL, "key" character varying NOT NULL, "user_id" bigint NOT NULL, PRIMARY KEY ("id"), CONSTRAINT "user_keys_users_user_keys" FOREIGN KEY ("user_id") REFERENCES "users" ("id") ON UPDATE NO ACTION ON DELETE NO ACTION);
-- create index "userkey_provider_key" to table: "user_keys"
CREATE UNIQUE INDEX "userkey_provider_key" ON "user_keys" ("provider", "key");
